name: "[Interviews] Google Chats PR Announcer"

on:
  workflow_dispatch:
  schedule:
    # Every Friday morning at 9AM
    - cron: "0 9 * * FRI"

jobs:
  prnouncer:
    runs-on: ubuntu-latest
    steps:
      - name: Use GitHub App Token
        uses: actions/create-github-app-token@v1
        id: app-token
        with:
          # These values are for the GitHub App "Gu PRnouncer config"
          # See https://github.com/organizations/guardian/settings/apps/gu-prnouncer-config (only accessible by GitHub owners)
          app-id: ${{ secrets.APP_ID }}
          private-key: ${{ secrets.PRIVATE_KEY }}
          owner: guardian

      - uses: guardian/actions-prnouncer@main
        with:
          google-webhook-url: ${{ secrets.INTERVIEWS_GOOGLE_WEBHOOK_URL }}
          github-repositories: guardian/coding-exercises,guardian/coding-exercise-project,guardian/interview-questions,guardian/redact-pdf
          github-token: ${{ steps.app-token.outputs.token }} # A GitHub app token generated by the previous step
